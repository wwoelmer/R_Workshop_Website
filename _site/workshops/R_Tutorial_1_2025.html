<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lesson 1 - Fundamentals of R – Introduction to R Workshop Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-df479d6c4d77d0e0dfbcb5361179d7fd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Introduction to R Workshop Series</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../workshops/R_Tutorial_1_2025.html" aria-current="page"> 
<span class="menu-text">Lesson 1: Fundamentals of R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/R_Tutorial_3_2025.html"> 
<span class="menu-text">Lesson 3: Manipulating and plotting data in R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../workshops/R_Tutorial_5_2025.html"> 
<span class="menu-text">Lesson 5: Statistical analyses in R</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#installing-packages" id="toc-installing-packages" class="nav-link" data-scroll-target="#installing-packages"><span class="header-section-number">1.1</span> Installing packages</a></li>
  <li><a href="#creating-objects" id="toc-creating-objects" class="nav-link" data-scroll-target="#creating-objects"><span class="header-section-number">1.2</span> Creating objects</a></li>
  <li><a href="#read-in-data-understand-data-classes-plot-data-create-new-column" id="toc-read-in-data-understand-data-classes-plot-data-create-new-column" class="nav-link" data-scroll-target="#read-in-data-understand-data-classes-plot-data-create-new-column"><span class="header-section-number">1.3</span> Read in data, understand data classes, plot data, create new column</a></li>
  <li><a href="#dataframe-structure" id="toc-dataframe-structure" class="nav-link" data-scroll-target="#dataframe-structure"><span class="header-section-number">1.4</span> Dataframe structure</a></li>
  <li><a href="#plotting-data" id="toc-plotting-data" class="nav-link" data-scroll-target="#plotting-data"><span class="header-section-number">1.5</span> Plotting data</a></li>
  </ul></li>
  <li><a href="#subset-data-plot-data-calculate-summary-statistics-write-a-csv" id="toc-subset-data-plot-data-calculate-summary-statistics-write-a-csv" class="nav-link" data-scroll-target="#subset-data-plot-data-calculate-summary-statistics-write-a-csv"><span class="header-section-number">2</span> Subset data, plot data, calculate summary statistics, write a csv</a>
  <ul class="collapse">
  <li><a href="#writing-a-.csv-file" id="toc-writing-a-.csv-file" class="nav-link" data-scroll-target="#writing-a-.csv-file"><span class="header-section-number">2.1</span> Writing a .csv file</a></li>
  <li><a href="#calculating-summary-statistics" id="toc-calculating-summary-statistics" class="nav-link" data-scroll-target="#calculating-summary-statistics"><span class="header-section-number">2.2</span> Calculating summary statistics</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 1 - Fundamentals of R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>This introductory lesson is designed to teach you the fundamentals of using RStudio to analyze environmental data. First we will learn how to install packages.</p>
<section id="installing-packages" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="installing-packages"><span class="header-section-number">1.1</span> Installing packages</h3>
<p>Packages provide new functions that can help us do specific actions in R. These will become increasingly useful as you learn more about R!</p>
<p>The main packages that we will use in this tutorial are:</p>
<ul>
<li><strong>tidyverse</strong></li>
<li><strong>readxl</strong></li>
</ul>
<p>Before attempting to install these packages, make sure your Primary CRAN Repository is set to:</p>
<ul>
<li><strong>“New Zealand [https] - University of Auckland”</strong></li>
</ul>
<p>To check this, click ‘Tools’ –&gt; ‘Global Options’ –&gt; ‘Packages’. Click ‘Change’ if you need to adjust this.</p>
<p>You can download most packages by clicking on the ‘Install’ button on the ‘packages’ tab in the lower right window pane. Then in the Install Packages popup, select ‘Repository (CRAN)’ from the ‘Install from’ drop box and type the name of the package you wish to download (e.g., dplyr).</p>
<p>You can also install packages directly using code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'tidyverse'</span>) <span class="co"># typically, R needs things to be in quotes, </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'tidyverse' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\wwoelmer\AppData\Local\Temp\RtmpQ3JgVB\downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># either '' or "" if it is not a recognized object in the environment</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'readxl'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'readxl' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\wwoelmer\AppData\Local\Temp\RtmpQ3JgVB\downloaded_packages</code></pre>
</div>
</div>
<p>Once all of these packages are installed you can load them using the ‘library’ function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readxl' was built under R version 4.4.3</code></pre>
</div>
</div>
<p>You can check if you have loaded your package by clicking on the ‘Packages’ tab, and navigate to the package name you just loaded. There should be a check next to it if it has been loaded properly. If you don’t see the package at all, that means it has not been installed.</p>
</section>
<section id="creating-objects" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="creating-objects"><span class="header-section-number">1.2</span> Creating objects</h3>
<p>One of the main ways that you will interact with R is to create and re-use objects. Let’s just creating a few objects ourselves. We did this for an in-person workshop where we counted the number of participants and instructors. However, you can change the code whatever you like! If you’re alone, maybe try changing it to the number of doorknobs and windows in your room.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>num_participants <span class="ot">&lt;-</span> <span class="dv">13</span><span class="co"># insert number of people in the room</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>num_instructors <span class="ot">&lt;-</span> <span class="dv">3</span><span class="co"># insert number of instructors in the room</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>participant_instructor_ratio <span class="ot">&lt;-</span> num_participants<span class="sc">/</span>num_instructors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Voila! You’ve created new objects! You should now see the objects in the upper right of your RStudio, in the Environment window.</p>
</section>
<section id="read-in-data-understand-data-classes-plot-data-create-new-column" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="read-in-data-understand-data-classes-plot-data-create-new-column"><span class="header-section-number">1.3</span> Read in data, understand data classes, plot data, create new column</h3>
<p>You can read in many different file formats into R and each will use their own function (e.g., read.csv, read.table, read_excel). To read in a file, you need to tell R where the file is located, relative to your working directory. To check where R is looking for your files, we will run the following function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/wwoelmer/OneDrive - The University of Waikato/Desktop/R_Workshop_Website/workshops"</code></pre>
</div>
</div>
<p>Running <code>getwd()</code> tells you <em>where</em> your working directory is located. Since we are using a project, your working directory will be where you put your project on your computer. If you don’t use a project, you will need to set a working directory using <code>setwd()</code>. However, I DO NOT recommend setting working directories for reproducibility reasons. If someone else wanted to run my code, they won’t have a <code>C:/Users/wwoelmer/Desktop/uni_files/</code> folder and will have to re-write the code to their own local directory…this causes lots of headaches. Projects are the best way to organize your files. But see other resources about this if desired: https://rpubs.com/em_/wdInR</p>
<p>Now let’s read in our water quality data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>wq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'./data/BoP_WQ_formatted.csv'</span>) <span class="co"># HINT: hit 'tab' as you're typin the directory to see a list of files in this directory</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The ./ notation means: look in the working directory (that is what the period represents), then in the folder data, then look for a file called BoP_WQ_formatted.csv</p>
<p>Now that we’ve read in our data, it’s best practice to look at it and see if everything looks alright.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(wq) <span class="co"># this opens up the dataframe to view, </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># you can also do this by clicking on your dataframe ('wq') in the Environment at right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataframe-structure" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="dataframe-structure"><span class="header-section-number">1.4</span> Dataframe structure</h3>
<p>Now that we’ve read in our data, let’s look at its structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3673 obs. of  20 variables:
 $ lake            : chr  "Okareka" "Okareka" "Okareka" "Okareka" ...
 $ site            : chr  "1" "1" "1" "1" ...
 $ date            : chr  "2000-07-11" "2000-08-23" "2000-09-28" "2000-10-25" ...
 $ chla_mgm3_top   : num  5.9 7.7 3.7 0.9 1.9 ...
 $ DRP_mgm3_bottom : num  2 0.5 0.5 4 6 2.25 3.5 3 2.9 5.85 ...
 $ DRP_mgm3_top    : num  0.5 0.5 0.5 0.5 2.5 0.5 1 0.5 3.55 0.5 ...
 $ NH4_mgm3_bottom : num  5 6 NA 11 8 3 15.5 7 20 31 ...
 $ NH4_mgm3_top    : num  6 9 3.5 2 10 ...
 $ NNN_mgm3_bottom : num  1 0.5 3 0.5 63 ...
 $ NNN_mgm3_top    : num  0.5 1 0.5 47.5 0.5 ...
 $ secchi_m        : num  6.5 6.9 9.1 11.1 8.4 9.3 9.4 9.6 9.6 9.7 ...
 $ TN_mgm3_bottom  : num  208 184 205 198 293 ...
 $ TN_mgm3_top     : num  176 184 196 268 234 ...
 $ TP_mg_m3_bottom : num  7 8 5 NA 6 ...
 $ TP_mgm3_top     : num  11 6 8.5 4 4 ...
 $ turb_NTU_bottom : num  1.06 0.93 1.4 2.4 0.97 ...
 $ turb_NTU_top    : num  1.5 1.1 0.75 0.7 0.83 ...
 $ pH_bottom       : num  7.3 7.4 7.2 7.1 7.1 ...
 $ pH_top          : num  7.2 7.4 7.55 7.9 7.85 ...
 $ chla_mgm3_bottom: num  NA NA NA NA NA NA NA NA NA NA ...</code></pre>
</div>
</div>
<p>Running the <code>str</code> function tells us the structure of each column in the dataframe. Now that we’ve looked at the structure of the <code>wq</code> dataframe, this shows us that the first three columns are of the character (chr) class, including <code>wq$date</code> But R has a specific data class for dates so we need to tell R that this is a date</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wq<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(wq<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Another formal class in R is a POSIXct object, which include date and time. Because datetimes are often in UTC, we will use as.POSIXct() to specify the time zone and ensure the right date</p>
<p>In this case, we will create a new column called ‘datetime’ which store both date and time zone ETC/GMT+12</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>wq<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(wq<span class="sc">$</span>date, <span class="at">tz =</span> <span class="st">"ETC/GMT+12"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we’ve set the <code>date</code> column as class date and created a new column of class POSIXct, let’s look at the structure again</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3673 obs. of  21 variables:
 $ lake            : chr  "Okareka" "Okareka" "Okareka" "Okareka" ...
 $ site            : chr  "1" "1" "1" "1" ...
 $ date            : Date, format: "2000-07-11" "2000-08-23" ...
 $ chla_mgm3_top   : num  5.9 7.7 3.7 0.9 1.9 ...
 $ DRP_mgm3_bottom : num  2 0.5 0.5 4 6 2.25 3.5 3 2.9 5.85 ...
 $ DRP_mgm3_top    : num  0.5 0.5 0.5 0.5 2.5 0.5 1 0.5 3.55 0.5 ...
 $ NH4_mgm3_bottom : num  5 6 NA 11 8 3 15.5 7 20 31 ...
 $ NH4_mgm3_top    : num  6 9 3.5 2 10 ...
 $ NNN_mgm3_bottom : num  1 0.5 3 0.5 63 ...
 $ NNN_mgm3_top    : num  0.5 1 0.5 47.5 0.5 ...
 $ secchi_m        : num  6.5 6.9 9.1 11.1 8.4 9.3 9.4 9.6 9.6 9.7 ...
 $ TN_mgm3_bottom  : num  208 184 205 198 293 ...
 $ TN_mgm3_top     : num  176 184 196 268 234 ...
 $ TP_mg_m3_bottom : num  7 8 5 NA 6 ...
 $ TP_mgm3_top     : num  11 6 8.5 4 4 ...
 $ turb_NTU_bottom : num  1.06 0.93 1.4 2.4 0.97 ...
 $ turb_NTU_top    : num  1.5 1.1 0.75 0.7 0.83 ...
 $ pH_bottom       : num  7.3 7.4 7.2 7.1 7.1 ...
 $ pH_top          : num  7.2 7.4 7.55 7.9 7.85 ...
 $ chla_mgm3_bottom: num  NA NA NA NA NA NA NA NA NA NA ...
 $ datetime        : POSIXct, format: "2000-07-10 12:00:00" "2000-08-22 12:00:00" ...</code></pre>
</div>
</div>
<p>Another data class we may want to use is ‘factor’. In <code>wq</code>, lake is listed as a character which means the different values have no particular order, and will appear alphabetically.</p>
<p>Let’s say we wanted to order them by increasing maximum depth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wq<span class="sc">$</span>lake <span class="ot">&lt;-</span> <span class="fu">factor</span>(wq<span class="sc">$</span>lake, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Rotoehu'</span>, <span class="st">'Rerewhakaaitu'</span>, <span class="st">'Okaro'</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">'Tikitapu'</span>, <span class="st">'Rotokakahi'</span>, <span class="st">'Okareka'</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">'Rotorua'</span>, <span class="st">'Okataina'</span>, <span class="st">'Rotoma'</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">'Tarawera'</span>, <span class="st">'Rotoiti'</span>, <span class="st">'Rotomahana'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><strong><em>Challenge 1:</em></strong> <em>What is the structure of <code>wq</code> now that you have updated the lake column?</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3673 obs. of  21 variables:
 $ lake            : Factor w/ 12 levels "Rotoehu","Rerewhakaaitu",..: 6 6 6 6 6 6 6 6 6 6 ...
 $ site            : chr  "1" "1" "1" "1" ...
 $ date            : Date, format: "2000-07-11" "2000-08-23" ...
 $ chla_mgm3_top   : num  5.9 7.7 3.7 0.9 1.9 ...
 $ DRP_mgm3_bottom : num  2 0.5 0.5 4 6 2.25 3.5 3 2.9 5.85 ...
 $ DRP_mgm3_top    : num  0.5 0.5 0.5 0.5 2.5 0.5 1 0.5 3.55 0.5 ...
 $ NH4_mgm3_bottom : num  5 6 NA 11 8 3 15.5 7 20 31 ...
 $ NH4_mgm3_top    : num  6 9 3.5 2 10 ...
 $ NNN_mgm3_bottom : num  1 0.5 3 0.5 63 ...
 $ NNN_mgm3_top    : num  0.5 1 0.5 47.5 0.5 ...
 $ secchi_m        : num  6.5 6.9 9.1 11.1 8.4 9.3 9.4 9.6 9.6 9.7 ...
 $ TN_mgm3_bottom  : num  208 184 205 198 293 ...
 $ TN_mgm3_top     : num  176 184 196 268 234 ...
 $ TP_mg_m3_bottom : num  7 8 5 NA 6 ...
 $ TP_mgm3_top     : num  11 6 8.5 4 4 ...
 $ turb_NTU_bottom : num  1.06 0.93 1.4 2.4 0.97 ...
 $ turb_NTU_top    : num  1.5 1.1 0.75 0.7 0.83 ...
 $ pH_bottom       : num  7.3 7.4 7.2 7.1 7.1 ...
 $ pH_top          : num  7.2 7.4 7.55 7.9 7.85 ...
 $ chla_mgm3_bottom: num  NA NA NA NA NA NA NA NA NA NA ...
 $ datetime        : POSIXct, format: "2000-07-10 12:00:00" "2000-08-22 12:00:00" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This shows that the lake column is now a factor!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<hr>
</section>
<section id="plotting-data" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="plotting-data"><span class="header-section-number">1.5</span> Plotting data</h3>
<p>Now let’s plot the <code>wq</code> data using the <code>ggplot</code> system. <code>ggplot</code> requires a dataframe (here, <code>wq</code>), and then the aesthetics or <code>aes()</code>. This tells it what to put on the x-axis and the y-axis. We have also told it to color the points based on the column <code>site</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wq, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(date), <span class="at">y =</span> DRP_mgm3_top, <span class="at">color =</span> site)) <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># this tells R how to "map" the data: in this case, use points</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span> <span class="co"># this makes a different panel for each lake, where the scale of both axes are different for each lake</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co"># this sets a 'theme' for how the plot looks, this is the 'black and white' setting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 322 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Tutorial_1_2025_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong><em>Challenge 2:</em></strong> <em>Create a different plot with <code>chla_mgm3_top</code> on the y-axis.</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wq, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(date), <span class="at">y =</span> chla_mgm3_top, <span class="at">color =</span> site)) <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="co"># this tells R how to "map" the data: in this case, use points</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">'free'</span>) <span class="sc">+</span> <span class="co"># this makes a different panel for each lake, where the scale of both axes are different for each lake</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co"># this sets a 'theme' for how the plot looks, this is the 'black and white' setting</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 97 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Tutorial_1_2025_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</details>
<hr>
</section>
</section>
<section id="subset-data-plot-data-calculate-summary-statistics-write-a-csv" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="subset-data-plot-data-calculate-summary-statistics-write-a-csv"><span class="header-section-number">2</span> Subset data, plot data, calculate summary statistics, write a csv</h2>
<p>We are now going to learn to subset data. Here, let’s subset the <code>wq</code> dataframe to select just one lake, I’ll pick Rotoehu. Below is an example of subsetting using the base functions in R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>rotoehu <span class="ot">&lt;-</span> wq[wq<span class="sc">$</span>lake<span class="sc">==</span><span class="st">'Rotoehu'</span>,] <span class="co"># the == means: look for an exact match</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this uses the base R notation of subset via brackets and indexing [rows, columns]</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here, we are saying take the dataframe wq</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then in brackets, we subset. here, we are saying keep only the rows where </span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># column 'lake' equals 'Rotoehu'. then we have a comma, and nothing after it,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># which means keep all of the columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A more intuitive way to subset dataframe is to use the <code>tidyverse</code> function <code>filter()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>rotoehu <span class="ot">&lt;-</span> wq <span class="sc">%&gt;%</span>  <span class="co"># this symbol is called a pipe, you can read it as 'whereby'</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lake<span class="sc">==</span><span class="st">'Rotoehu'</span>) <span class="co"># here we say filter out every row where the lake column</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># equals 'Rotoehu' (remember R is sensitive to capitals)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using our subsetted dataframe <code>rotoehu</code>, let’s plot the data using ggplot. We can also clean up our axis labels a bit using the functions <code>xlab</code> and <code>ylab</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rotoehu, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(date), <span class="at">y =</span> chla_mgm3_top)) <span class="sc">+</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">'Date'</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Chl-a (mg/m3)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Tutorial_1_2025_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong><em>Challenge 3:</em></strong> <em>Modify the ggplot code above to plot TN_mgm3_top in the <code>rotoehu</code> dataframe. Make sure your axis labels are accurate.</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rotoehu, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(date), <span class="at">y =</span> TN_mgm3_top)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Total Nitrogen (mg/m3)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Tutorial_1_2025_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</details>
<hr>
<section id="writing-a-.csv-file" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="writing-a-.csv-file"><span class="header-section-number">2.1</span> Writing a .csv file</h3>
<p>Now let’s save this subsetted data as a new csv file. First, we will bring up the help documentation for the function <code>write.csv()</code> so we can see what information (called arguments) the function needs us to input</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>?write.csv <span class="co"># bring up the help documentation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on the help documentation, we can see there are lots of arguments, but most of them have defaults. The information that R needs to know includes <code>x</code>, which is the object we are exporting (in this case, the dataframe <code>rotoehu</code>), <code>file</code> which corresponds to the the location where we want to save the file (in this case, we will save it in the <code>data</code> folder and called the file <code>rotoehu_wq.csv</code>), and we want to set the argument <code>row.names = FALSE</code> so that the file isn’t written with an extra column naming the rows</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(rotoehu, <span class="co"># this is the object we want to export</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">'./data/rotoehu_wq.csv'</span>,  <span class="co"># the . means go from the working directory, </span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="co"># which is our project directory (check getwd() to clarify)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># then we are writing inside the 'data' folder</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># and can call the file whatever we want, with the </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># .csv extension. here, I've named it 'rotoehu_wq_2000_2021.csv</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># the row.names should be set as FALSE</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># to avoid having an extra column in the csv file which lists the row number</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-summary-statistics" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="calculating-summary-statistics"><span class="header-section-number">2.2</span> Calculating summary statistics</h3>
<p>Now that we’ve subset our data, let’s calculate some summary statistics and save them as a new object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mean_chl <span class="ot">&lt;-</span> <span class="fu">mean</span>(rotoehu<span class="sc">$</span>chla_mgm3_top)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean_chl) <span class="do">#### hm that says NA, which means we need to remove the NA's before we take the mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Hmmm that says the <code>mean_chl</code> is <code>NA</code>. Look at the <code>rotoehu</code> dataframe: are all the chla values NA? No…which means there must be some NA’s in there which have thrown R off. We need to remove the NA’s before we take the mean. Look at help documentation (?mean) and read about the <code>na.rm</code> argument. We need to add the argument na.rm, then rerun the mean calculation</p>
<hr>
<p><strong><em>Challenge 4:</em></strong> <em>Use the <code>na.rm</code> argument within the <code>mean</code> function to calculate the mean chl-a in Lake Rotoehu.</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mean_chl <span class="ot">&lt;-</span> <span class="fu">mean</span>(rotoehu<span class="sc">$</span>chla_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mean_chl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.24727</code></pre>
</div>
</div>
</details>
<hr>
<hr>
<p><strong><em>Challenge 5:</em></strong> <em>You’re on a roll! Not calculate the standard deviation using the function <code>sd()</code>. Don’t forget to use the <code>na.rm</code> function.</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sd_chl <span class="ot">&lt;-</span> <span class="fu">sd</span>(rotoehu<span class="sc">$</span>chla_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sd_chl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.716998</code></pre>
</div>
</div>
</details>
<hr>
<hr>
<p><strong><em>Challenge 6:</em></strong> <em>Lastly, calculate the minimum and maximum values of chl-a in Lake Rotoehu.</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>min_chl <span class="ot">&lt;-</span> <span class="fu">min</span>(rotoehu<span class="sc">$</span>chla_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>max_chl <span class="ot">&lt;-</span> <span class="fu">max</span>(rotoehu<span class="sc">$</span>chla_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(min_chl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(max_chl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96.4</code></pre>
</div>
</div>
</details>
<hr>
<hr>
<p><strong><em>Challenge 7:</em></strong> <em>To wrap up this section, let’s have a big challenge where you repeat this excercise but for Lake Rotoma DRP instead. Remember that you need to 1) subset the original <code>wq</code> dataframe using either indexing or filter(), 2) plot the surface (top) DRP data for Lake Rotoma, 3) calculate the mean, sd, minimum, and maximum of DRP.</em></p>
<details>
<summary>
Click to see a solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>rotoma <span class="ot">&lt;-</span> wq <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(lake <span class="sc">==</span> <span class="st">"Rotoma"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rotoma, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.Date</span>(date), <span class="at">y =</span> DRP_mgm3_top)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Date"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Dissolved Reactive Phosporus at surface (mg/m3)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 6 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Tutorial_1_2025_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(rotoma<span class="sc">$</span>DRP_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.517479</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(rotoma<span class="sc">$</span>DRP_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.647017</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(rotoma<span class="sc">$</span>DRP_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(rotoma<span class="sc">$</span>DRP_mgm3_top, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.1286</code></pre>
</div>
</div>
</details>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>